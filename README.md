# Cpp-study

## Taks1 简易计算器

## 作者: 刘昊

### 运行结果截屏
- ![task1](https://github.com/lh-01/Cpp-study/assets/81234347/4f3a98c1-3b74-4e4a-8a05-8e53aa164df5)


### 简单说明
- 代码使用了两个栈，一个用于保存操作数，一个用于保存运算符。通过迭代扫描输入的表达式，按照运算符的优先级进行运算，最终得到结果。
- precedence 函数用于判断运算符的优先级，返回一个整数值。值越大表示优先级越高。
- applyOperation 函数根据给定的运算符和操作数，返回运算结果。
- evaluateExpression 函数用于计算给定表达式的值。在遍历表达式时，它将数字压入操作数栈中，将运算符压入运算符栈中，并根据运算符的优先级进行计算。
- main 函数负责不断接收用户输入的表达式，调用 evaluateExpression 函数计算结果并输出。 

### 花费时间
-  4小时

## Taks2 简易文字聊天程序

## 作者: 刘昊

### 运行结果截屏
#### 服务器端
- ![服务器](https://github.com/lh-01/Cpp-study/assets/81234347/3e6ac5f1-204d-4644-87aa-183fe5423003)
#### 客户端1
- ![客户端1_1](https://github.com/lh-01/Cpp-study/assets/81234347/0025e8c8-6d39-464a-b7bd-043a23f5f3b2)
- ![客户端1_2](https://github.com/lh-01/Cpp-study/assets/81234347/dd3609c1-7236-4f3d-932c-afd704e0938f)
#### 客户端2
- ![客户端2_1](https://github.com/lh-01/Cpp-study/assets/81234347/ddc8c8f7-00d5-49c1-8370-3b7ff51e2fba)
- ![客户端2_2](https://github.com/lh-01/Cpp-study/assets/81234347/4fc7d061-5853-46eb-a853-75560a87f7f9)

### 简单说明
 - 该程序分为客户端程序和服务器端程序，在主程序中用户输入不同的选项执行不同的功能。
 - 在客户端程序中，创建了Client类，主要包括连接服务器、登录、注销、发送消息和接收消息等功能。在Client类中包括构造函数Client()用于初始化Winsock和创建客户端套接字，connectToServer()方法用于连接指定的服务器，login()方法用于登录服务器，logout()方法用于注销登录，sendMessage()方法用于向指定用户发送消息，receiveMessage()方法用于接收消息。
 - 在服务器端程序中，创建了Server类，主要包括启动服务器、处理客户端请求、处理登录、注销和发送消息等功能。在Server类中包括构造函数Server()用于初始化Winsock和创建服务器端套接字，start()函数中用于启动服务器，绑定指定端口并开始监听，等待客户端的连接请求。一旦接受到客户端的连接请求，就创建一个新的套接字与客户端进行通信，处理客户端的登录、注销和发送消息请求，login()方法用于处理登录请求，logout()方法用于处理注销请求，sendMessage()用于将消息发送到指定客户端，getSocketByUsername()方法用于根据用户名获取套接字。

### 花费时间
-  4d
  
## Taks3.3 基于 ffmpeg 的音视频播放器

## 作者: 刘昊

### 运行结果录屏
- 录屏链接

### 简单说明
- 在主函数中首先初始化了FFmpeg和SDL库，然后从用户输入中获取音视频文件的路径。接下来获取音视频文件的格式上下文(AVFormatContext)，并使用avformat_open_input函数打开该音视频文件。然后使用avformat_find_stream_info函数检索音视频流的信息，并查找音视频流。初始化音视频解码器，获取音视频解码器参数(AVCodecParameters)和解码器(AVCodec)，并使用avcodec_parameters_to_context函数设置解码器的参数。使用avcodec_open2函数打开音视频解码器。初始化SDL，并创建窗口、渲染器和纹理。创建音频处理线程和视频处理线程。等待音频和视频线程准备好。发送同步信号，开始播放。进入主循环，监听SDL事件，包括退出事件和按键事件。根据事件类型和按键来控制播放器的操作，暂停、重新播放、前进和后退、音量加减等。当退出事件触发或播放结束时，跳出主循环。等待音频和视频处理线程结束。释放相关资源，包括关闭和释放格式上下文、解码器上下文，销毁窗口、渲染器和纹理，退出SDL。
- 在视频处理线程中，先定义了源矩形(srcRect)和目标矩形(dstRect)，分别用于指定视频帧的源区域和渲染到窗口的目标区域。接着计算缩放比例，用于将视频帧缩放到目标矩形的尺寸。然后进入循环，通过av_read_frame函数逐帧读取视频数据包。通过判断数据包的流索引是否为视频流索引(videoStreamIndex)，确定是否为视频数据包。发送视频数据包到解码器，调用avcodec_send_packet函数。接收解码后的视频数据帧，通过avcodec_receive_frame函数。通知主线程视频播放准备好，并等待主线程的播放信号。更新目标矩形的尺寸，根据缩放比例计算。渲染视频帧，使用SDL_UpdateYUVTexture函数更新纹理，使用SDL_RenderCopy函数将纹理渲染到目标矩形，最后调用SDL_RenderPresent函数显示渲染结果。使用SDL_Delay函数控制每帧间的延迟时间，以控制播放速度。在循环过程中，程序会获得视频控制变量，当用户按下空格键时暂停视频播放，再次按下空格键继续播放，按下’q’键退出播放，按下’r’键重新回到视频开头，按下右键视频前进30s,按下左键视频后退30s。在循环结束后，释放视频帧和数据包的内存。
- 在音频处理线程中，首先使用OpenAL库创建一个音频设备(device)和上下文(context)。如果无法创建上下文，则释放资源，关闭设备，关闭编解码器，关闭输入格式上下文，并退出函数。创建一个OpenAL源(source)，用于播放音频。设置源的属性，包括音调(PITCH)、音量(GAIN)、位置(POSITION)、速度(VELOCITY)和循环(AL_LOOPING)等。创建一个音频缓冲器数组(buffers)。分配一个AVPacket结构体(packet)用于存储音频数据包。进入循环，通过av_read_frame函数逐帧读取音频数据包。判断数据包的流索引是否为音频流索引(audioStreamIndex)，确定是否为音频数据包。将音频数据包发送到解码器，调用avcodec_send_packet函数。在循环中，调用avcodec_receive_frame函数接收解码后的音频数据帧。设置目标音频帧(targetFrame)的属性，包括格式(format)、声道数(channels)、声道布局(channel_layout)、采样率(sample_rate)和样本数(nb_samples)等。使用swr_alloc_set_opts函数设置音频转换上下文(swrContext)的参数。使用swr_init函数初始化音频转换上下文。使用swr_convert_frame函数执行音频帧的转换，将源音频帧(frame)转换为目标音频帧(targetFrame)。创建一个音频缓冲器(buffer)。将目标音频帧的数据填充到缓冲器中，使用alBufferData函数。将缓冲器添加到音频源的队列中，使用alSourceQueueBuffers函数。检查音频源的状态，如果尚未播放，则调用alSourcePlay函数开始播放。检查音频队列中的缓冲器数量，如果超过预设的缓冲器数量(NUM_BUFFERS)，则循环等待并释放已处理的缓冲器，直到队列中的缓冲器数量小于预设数量。释放音频帧和目标音频帧的内存。在循环过程中，程序会获得视频控制变量，当用户按下空格键时暂停视频播放，再次按下空格键继续播放，按下’q’键退出播放，按下’r’键重新回到视频开头，按下右键视频前进30s,按下左键视频后退30s，按上键音量增加、按下键音量减小，在循环结束后，释放音频缓冲器和音频数据包的内存。

### 花费时间
- 7d
  
## Taks3.1.a 基于SDL的yuv图像播放器

## 作者: 刘昊

### 运行结果录屏
- 录屏链接

### 简单说明
- 代码中的initSDL函数用于初始化SDL库、创建窗口、渲染器和纹理，确保SDL环境正确设置。
playYUV函数用于播放YUV视频文件。首先打开指定的YUV视频文件，然后循环读取视频帧数据并进行渲染。每次循环，它调用SDL_UpdateTexture更新纹理，然后通过SDL_RenderCopy将纹理复制到渲染器上并调用SDL_RenderPresent将渲染内容显示在窗口上。
在循环过程中，程序会监听SDL事件，当用户按下空格键时暂停视频播放，再次按下空格键继续播放。按下’q’键退出播放，按下’r’键重新回到视频开头。当用户点击窗口关闭按钮时，程序也会退出。
代码通过使用SDL库提供的函数和事件处理机制，实现了一个简单的YUV视频播放器，它能够显示YUV格式的视频文件，并且支持暂停、继续、退出和重新播放等功能。

### 花费时间
- 2d
  
## Taks3.1.b 基于SDL的mp4视频播放器

## 作者: 刘昊

### 运行结果录屏
- 录屏链接

### 简单说明
 #### 方式1：task3.1.b_yuv
- 代码中使用FFmpeg库解码和SDL库显示视频，将输入的mp4视频文件解码为原始视频帧，并通过SDL库将帧渲染到窗口上。
 程序中首先初始化SDL和FFmpeg库，并获取要播放的mp4视频文件路径，并打开该文件。然后，程序根据视频流的类型找到视频流并获得视频编解码器。接下来，程序将视频帧解码并调用SDL函数进行渲染。
 在videoPlayer函数中，程序循环读取视频帧的数据，并对帧进行解码、转换和渲染。它通过调用av_read_frame函数读取一个音频或视频包，然后检查包的流索引是否与视频流索引匹配。如果匹配，就解码视频包，并通过SDL函数渲染视频帧。循环中，包的数据通过avcodec_send_packet函数发送给解码器，并通过avcodec_receive_frame函数接收解码后的帧。然后，将帧数据更新到SDL纹理中，然后将纹理复制到渲染器上，并调用SDL_RenderPresent函数显示渲染内容。通过SDL_Delay函数，控制帧率。在循环过程中，程序会监听SDL事件，当用户按下空格键时暂停视频播放，再次按下空格键继续播放。按下’q’键退出播放，按下’r’键重新回到视频开头，按下右键视频前进30s,按下左键视频后退30s。当用户点击窗口关闭按钮时，程序也会退出。最后，程序在结束之前进行内存释放和清理工作，并关闭SDL和FFmpeg库。
 #### 方式2：task3.1.b_rgb
- 代码中使用FFmpeg库解码和SDL库显示视频，将输入的mp4视频文件解码为原始视频帧，并通过SDL库将帧渲染到窗口上。
initializeSDL()函数通过调用SDL库的相关函数来初始化SDL，并创建窗口、渲染器和纹理用于显示视频内容。
renderRGB()函数将RGB数据渲染到SDL的纹理上，并通过渲染器进行显示。
cleanup()函数用于清理SDL相关资源，包括销毁纹理、渲染器和窗口，并调用SDL库的清理函数。
playVideo()函数是主要的视频播放函数。它首先初始化FFmpeg库，然后打开并检索视频文件的信息。接着查找视频流，并获取其解码器参数。接下来，根据解码器参数查找相应的解码器，并创建解码器上下文。然后打开解码器。输出视频的格式信息，包括像素格式、宽度、高度和比特率。调用initializeSDL()函数初始化SDL。进入循环，不断读取视频帧。如果帧是视频帧，则解码并进行颜色空间转换，然后调用renderRGB()函数渲染和显示RGB数据。在循环中使用SDL_Delay()函数来控制帧率，使视频播放流畅。在循环过程中，程序会监听SDL事件，当用户按下空格键时暂停视频播放，再次按下空格键继续播放。按下’q’键退出播放，按下’r’键重新回到视频开头，按下右键视频前进30s,按下左键视频后退30s。当用户点击窗口关闭按钮时，程序也会退出。在循环结束后，释放相关资源，包括帧和数据包的内存，以及解码器上下文等。

### 花费时间
- 2d
  
